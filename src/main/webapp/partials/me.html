
<div class="container">

  <div class="row">    
    <div class="col-md-3">
        <img ng-src="{{KexUtil.strConcat(me.profileImage.url,'?type=large')}}" class="img-responsive center">
        <div class="text-center">
            <h4><strong><em>+{{me.karmaPoints}} karma</em></strong></h4>            
        </div>
    </div>
    <div class="col-md-9">

        <h3 class="profile-view-name"><strong>{{me.firstName}}</strong></h3>
        
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">
                    Introduction <small> <i ng-show="{ALL:true}[me.permission]" class="icon-edit" ng-click="enableEdit()"></i></small>
                </h3>

            </div>
            <div class="panel-body">
                <ng-switch on="edit">
                
                    <div ng-switch-when="true">
                        <div>
                            <textarea rows="5" class="col-md-12" ng-model="$parent.me.about" ></textarea>
                        </div>
                        <div class="vertical-panel-padding">
                            <button class="btn btn-primary" ng-click="saveEdit()">Save</button>
                            <button class="btn btn-default" ng-click="disableEdit()">Cancel</button>
                        </div>
                    </div>
                    
                    <div ng-switch-default ng-click="enableEdit()">
                        <p ng-bind-html-unsafe="me.about | noHTML | newlines" />
                    </div>
                    
                </ng-switch>
            </div>
        </div>
        

        <div class="panel panel-default" ng-show="orgs.data.length">
            <div class="panel-heading">
                <div class="row">
                    <div class="col-md-6">
                        <h3 class="panel-title">
                            I am an organizer for                    
                        </h3>
                    </div>
                    <div class="col-md-6 text-right">
                        Organizer rating:
                        <rating value="me.eventOrganizerRating.value" max="5" readonly="true"></rating> 
                        ({{me.eventOrganizerRating.count}})
                    </div>
                </div>
            </div>
            <div class="panel-body">

                <div class="row">
                    <div class="col-md-6" ng-repeat="org in orgs.data">
                        <div class="well well-sm">
                            <a href="#/org/{{org.org.key}}">
                                <img ng-src="{{fbUtil.getImageUrl(org.orgPage.name, 'square')}}" class="kex-thumbnail-with-label kex-thumbnail-org-small">{{org.orgName}}
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        
    </div>
  </div>

  <div class="row vertical-panel-padding">
    <div class="col-md-12">
        <tabset>
            <tab>
                <tab-heading>
                    <i class="icon-bolt">
                    </i>
                    Impact
                </tab-heading>

                <div class="row" ng-repeat="event in pastEvents.data">
                    <div class="col-md-6">                        
                        <div class="well well-sm">
                            <div class="row">
                                <div class="col-md-12">

                                    <div class="pull-left">
                                        <div class="font-size-h4">
                                            <strong>
                                                <a href="#/event/{{event.key}}"><strong>{{event.title}} </strong></a>
                                            </strong>                                            
                                        </div>

                                        <div>
                                            <div class="pull-left">
                                                <a href="#/org/{{event.organization.key}}">
                                                    <img ng-src="{{fbUtil.getImageUrl(event.organizationDetails.page.name, 'square')}}" class="kex-thumbnail-with-label kex-thumbnail-org-small">                                                
                                                </a>
                                            </div>
                                            <div class="pull-left">
                                                <div>
                                                    <a href="#/org/{{event.organization.key}}">
                                                        {{event.organizationDetails.orgName}}
                                                    </a>
                                                </div>
                                                <div><small>{{event.startTime | date:'mediumDate'}}</small></div>
                                            </div>
                                        </div>

                                    </div>

                                    <div class="pull-right responsive-div-pad-left">
                                        <div>
                                            <div class="pull-right font-size-h4">
                                                <strong>
                                                    <em>
                                                        +{{event.karmaPoints}} karma
                                                    </em>
                                                </strong>
                                            </div>                                            
                                        </div>
                                        <div>
                                            <div class="pull-right">
                                                <event-registration-info 
                                                    registration-info="event.userEventSearchInfo.registrationInfo"
                                                    type="PAST">
                                                </event-registration-info>
                                            </div>                                            
                                        </div>
                                        <div>
                                            <div ng-show="{ALL:true}[me.permission] && EventUtil.canWriteReview(event)" class="pull-right">
                                                <event-user-rating 
                                                    user-rating="event.currentUserRating"
                                                    event-key="event.key">
                                                </event-user-rating>
                                            </div>                                            
                                        </div>
                                        <div>
                                            <div ng-hide="{ALL:true}[me.permission] && EventUtil.canWriteReview(event)" class="pull-right">
                                                <aggregate-rating value="event.rating">
                                                </aggregate-rating>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-12" ng-show="event.impactSummary">
                                    <div class="border-top-1 vertical-panel-padding" ng-bind-html-unsafe="event.impactSummary | noHTML | newlines"></div>
                                </div>
                            </div>
                            
                            <div class="row vertical-panel-padding" ng-show="event.album">
                                <div class="col-md-12">
                                    <img ng-src="{{event.album.coverPhotoUrl}}" class="img-responsive">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </tab>
            <tab>
                <tab-heading>
                    <i class="icon-list">
                    </i>
                    Upcoming Events
                </tab-heading>

                <ul class="list-unstyled">
                    <li ng-repeat="event in events.data">
                        <div class="row well well-sm col-md-12">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-12">
                                        <strong >{{event.startTime | date:'mediumDate'}}</strong>
                                        <a href="#/event/{{event.key}}"><strong>{{event.title}} </strong></a> 
                                        <button disabled="disabled" type="button" class="btn btn-info btn-xs pull-right" ng-show="{ORGANIZER:true}[event.registrationInfo]" ><small>organizer</small></button>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <small class="text-muted">{{event.startTime | date:'shortTime'}} - {{event.endTime | date:'shortTime'}}</small>
                                        <small class="text-muted">at {{event.location.title}}, {{event.location.address.city}}</small>
                                        <div class="pull-right">
                                                <event-participant-imgs-mini event="event"></event-participant-imgs-mini>
                                        </div>                                                                                    
                                    </div>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>

            </tab>
        </tabset>
    </div>
  </div>

</div>

